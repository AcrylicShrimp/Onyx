load("@rules_cc//cc:defs.bzl", "cc_library", "objc_library")

objc_library(
    name = "window_osx",
    srcs = ["src/display/window__OSX__backend.m"],
    hdrs = ["includes/display/window__OSX__backend.h"],
)

cc_library(
    name = "main",
    srcs = [
        "src/common/manager.cpp",
        "src/common/version.cpp",
        "src/core/context.cpp",
        "src/core/contextManager.cpp",
        "src/core/deviceInfo.cpp",
        "src/core/deviceManager.cpp",
        "src/core/perContextManager.cpp",
        "src/core/renderingManager.cpp",
        "src/core/surfaceManager.cpp",
        "src/core/swapchainManager.cpp",
        "src/core/synchronizationManager.cpp",
        "src/display/displayManager.cpp",
        "src/display/window.cpp",
        "src/display/window__OSX.cpp",
        "src/display/window__WINDOWS.cpp",
        "src/onyx.cpp",
        "src/render/core/material.cpp",
        "src/render/core/mesh.cpp",
        "src/render/core/meshElement.cpp",
        "src/render/core/shader.cpp",
        "src/render/helper.cpp",
    ],
    hdrs = [
        "includes/common/manager.h",
        "includes/common/platform.h",
        "includes/common/version.h",
        "includes/core/context.h",
        "includes/core/contextManager.h",
        "includes/core/deviceInfo.h",
        "includes/core/deviceManager.h",
        "includes/core/perContextManager.h",
        "includes/core/renderingManager.h",
        "includes/core/surfaceManager.h",
        "includes/core/swapchainManager.h",
        "includes/core/synchronizationManager.h",
        "includes/core/vulkan.h",
        "includes/display/displayManager.h",
        "includes/display/window.h",
        "includes/display/window__OSX.h",
        "includes/display/window__WINDOWS.h",
        "includes/onyx.h",
        "includes/render/core/material.h",
        "includes/render/core/mesh.h",
        "includes/render/core/meshElement.h",
        "includes/render/core/shader.h",
        "includes/render/helper.h",
        "includes/transform/mat.h",
        "includes/transform/mat22.h",
        "includes/transform/mat22.hpp",
        "includes/transform/mat23.h",
        "includes/transform/mat23.hpp",
        "includes/transform/mat24.h",
        "includes/transform/mat24.hpp",
        "includes/transform/mat32.h",
        "includes/transform/mat32.hpp",
        "includes/transform/mat33.h",
        "includes/transform/mat33.hpp",
        "includes/transform/mat34.h",
        "includes/transform/mat34.hpp",
        "includes/transform/mat42.h",
        "includes/transform/mat42.hpp",
        "includes/transform/mat43.h",
        "includes/transform/mat43.hpp",
        "includes/transform/mat44.h",
        "includes/transform/mat44.hpp",
        "includes/transform/matmul.hpp",
        "includes/transform/vec.h",
        "includes/transform/vec2.h",
        "includes/transform/vec2.hpp",
        "includes/transform/vec3.h",
        "includes/transform/vec3.hpp",
        "includes/transform/vec4.h",
        "includes/transform/vec4.hpp",
    ],
    copts = [
        "-std=c++2a",
    ],
    linkopts = [
        "-framework Foundation",
        "-framework Cocoa",
        "-framework QuartzCore",
    ],
    visibility = ["//visibility:public"],
    deps = [
        ":window_osx",
        "@com_chaoticbob_spirv_reflect//:main",
        "@com_lunarg_vulkan_sdk//:main",
    ],
)
